{% extends "base.html" %}

{% block title %}Account Settings - Plant Care AI Assistant - PlantCareAI{% endblock %}

{% block content %}
<!-- Breadcrumb Navigation -->
<nav aria-label="Breadcrumb" class="mb-6">
  <ol class="flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400">
    <li><a href="{{ url_for('dashboard.index') }}" class="hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors">Dashboard</a></li>
    <li aria-hidden="true">â†’</li>
    <li aria-current="page" class="text-slate-900 dark:text-slate-100 font-medium">Account Settings</li>
  </ol>
</nav>

<!-- Page Header -->
<div class="mb-8">
  <h2 class="text-3xl sm:text-4xl font-bold text-slate-900 dark:text-slate-100 mb-2">
    Account Settings <span class="inline-block" aria-hidden="true">âš™ï¸</span>
  </h2>
  <p class="text-lg text-slate-600 dark:text-slate-400">
    Manage your profile, plan, and preferences.
  </p>
</div>

<!-- Account Information -->
<section class="card mb-8" aria-labelledby="account-info-title">
  <h3 id="account-info-title" class="section-title">Account Information</h3>

  <dl class="space-y-4">
    <div class="flex items-start gap-3 pb-4 border-b border-slate-200 dark:border-slate-700">
      <dt class="text-2xl flex-shrink-0" aria-hidden="true">ğŸ“§</dt>
      <div class="flex-1">
        <dt class="text-sm font-medium text-slate-700 dark:text-slate-300">Email Address</dt>
        <dd class="mt-1 text-base text-slate-900 dark:text-slate-100">{{ profile.email if profile else current_user.email }}</dd>
      </div>
    </div>

    <div class="flex items-start gap-3 pb-4 border-b border-slate-200 dark:border-slate-700">
      <dt class="text-2xl flex-shrink-0" aria-hidden="true">ğŸ†”</dt>
      <div class="flex-1">
        <dt class="text-sm font-medium text-slate-700 dark:text-slate-300">Account ID</dt>
        <dd class="mt-1 text-base font-mono text-slate-900 dark:text-slate-100 bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded inline-block">{{ current_user.id[:8] }}...</dd>
      </div>
    </div>

    <div class="flex items-start gap-3">
      <dt class="text-2xl flex-shrink-0" aria-hidden="true">ğŸ“…</dt>
      <div class="flex-1">
        <dt class="text-sm font-medium text-slate-700 dark:text-slate-300">Member Since</dt>
        <dd class="mt-1 text-base text-slate-900 dark:text-slate-100">{{ current_user.created_at.strftime('%B %d, %Y') if current_user.created_at else 'Recently' }}</dd>
      </div>
    </div>
  </dl>
</section>

<!-- Subscription & Plan -->
<section class="card mb-8" aria-labelledby="subscription-title">
  <h3 id="subscription-title" class="section-title">Subscription & Plan</h3>

  <!-- Current Plan Badge -->
  <div class="flex items-center gap-4 p-4 mb-4 bg-gradient-to-r from-emerald-50 to-cyan-50 dark:from-emerald-900/20 dark:to-cyan-900/20 rounded-xl border-2 border-emerald-200 dark:border-emerald-700">
    <span class="text-4xl" aria-hidden="true">ğŸŒ±</span>
    <div>
      <strong class="text-lg text-slate-900 dark:text-slate-100">Starter Plan</strong>
      <p class="text-sm text-slate-600 dark:text-slate-400">Free forever, up to 20 plants</p>
    </div>
  </div>

  <div class="mb-4">
    <p class="text-slate-900 dark:text-slate-100 mb-2">You're on the <strong>Starter</strong> plan (free forever).</p>
    <p class="text-sm text-slate-500 dark:text-slate-400">All core features included. Premium options will be available in the future for power users who want advanced features like unlimited plants, AI image diagnosis, and export tools.</p>
  </div>

  <!-- Plan Comparison -->
  <details class="rounded-xl border border-slate-200 dark:border-slate-700">
    <summary class="px-4 py-3 cursor-pointer font-medium text-slate-900 dark:text-slate-100 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors rounded-xl">
      Compare plans
    </summary>
    <div class="px-4 pb-4 border-t border-slate-200 dark:border-slate-700 overflow-x-auto">
      <table class="w-full mt-4">
        <caption class="sr-only">Plan feature comparison</caption>
        <thead>
          <tr class="border-b border-slate-200 dark:border-slate-700">
            <th scope="col" class="text-left py-2 px-3 text-sm font-semibold text-slate-700 dark:text-slate-300">Feature</th>
            <th scope="col" class="text-center py-2 px-3 text-sm font-semibold text-slate-700 dark:text-slate-300">Starter</th>
            <th scope="col" class="text-center py-2 px-3 text-sm font-semibold text-slate-700 dark:text-slate-300">Premium</th>
          </tr>
        </thead>
        <tbody class="text-sm">
          <tr class="border-b border-slate-200 dark:border-slate-700">
            <th scope="row" class="text-left py-2 px-3 font-medium text-slate-900 dark:text-slate-100">Plants</th>
            <td class="text-center py-2 px-3 text-slate-700 dark:text-slate-300">Up to 20</td>
            <td class="text-center py-2 px-3 text-slate-700 dark:text-slate-300">Unlimited</td>
          </tr>
          <tr class="border-b border-slate-200 dark:border-slate-700">
            <th scope="row" class="text-left py-2 px-3 font-medium text-slate-900 dark:text-slate-100">Care reminders</th>
            <td class="text-center py-2 px-3">âœ“</td>
            <td class="text-center py-2 px-3">âœ“</td>
          </tr>
          <tr class="border-b border-slate-200 dark:border-slate-700">
            <th scope="row" class="text-left py-2 px-3 font-medium text-slate-900 dark:text-slate-100">AI assistant</th>
            <td class="text-center py-2 px-3">âœ“</td>
            <td class="text-center py-2 px-3">âœ“</td>
          </tr>
          <tr class="border-b border-slate-200 dark:border-slate-700">
            <th scope="row" class="text-left py-2 px-3 font-medium text-slate-900 dark:text-slate-100">Photo uploads</th>
            <td class="text-center py-2 px-3">âœ“</td>
            <td class="text-center py-2 px-3">âœ“</td>
          </tr>
          <tr class="border-b border-slate-200 dark:border-slate-700">
            <th scope="row" class="text-left py-2 px-3 font-medium text-slate-900 dark:text-slate-100">AI image diagnosis</th>
            <td class="text-center py-2 px-3 text-slate-400">â€”</td>
            <td class="text-center py-2 px-3 text-slate-700 dark:text-slate-300">Coming soon</td>
          </tr>
          <tr class="border-b border-slate-200 dark:border-slate-700">
            <th scope="row" class="text-left py-2 px-3 font-medium text-slate-900 dark:text-slate-100">CSV/PDF export</th>
            <td class="text-center py-2 px-3 text-slate-400">â€”</td>
            <td class="text-center py-2 px-3">âœ“</td>
          </tr>
          <tr class="border-b border-slate-200 dark:border-slate-700">
            <th scope="row" class="text-left py-2 px-3 font-medium text-slate-900 dark:text-slate-100">Seasonal task generator</th>
            <td class="text-center py-2 px-3 text-slate-400">â€”</td>
            <td class="text-center py-2 px-3">âœ“</td>
          </tr>
          <tr>
            <th scope="row" class="text-left py-2 px-3 font-medium text-slate-900 dark:text-slate-100">Priority support</th>
            <td class="text-center py-2 px-3 text-slate-400">â€”</td>
            <td class="text-center py-2 px-3">âœ“</td>
          </tr>
        </tbody>
      </table>
    </div>
  </details>
</section>

<!-- Preferences -->
<section class="card mb-8" aria-labelledby="preferences-title">
  <h3 id="preferences-title" class="section-title">Preferences</h3>

  <form method="POST" action="{{ url_for('dashboard.account') }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

    <!-- Location -->
    <div class="mb-6">
      <label for="city" class="label">
        Location <span class="text-sm font-normal text-slate-500 dark:text-slate-400">(Optional)</span>
      </label>
      <p id="city-help" class="help-text">
        Enter your city or ZIP code for weather-aware reminder adjustments.
        <br>
        <em>Example: Austin, TX or 78701</em>
      </p>
      <input
        type="text"
        id="city"
        name="city"
        class="input"
        value="{{ profile.city if profile and profile.city else '' }}"
        placeholder="Enter city or ZIP code"
        aria-describedby="city-help"
        maxlength="200"
      />
    </div>

    <!-- Theme Preference -->
    <div class="mb-8">
      <label class="label">
        Theme Preference
      </label>
      <p id="theme-help" class="help-text">
        Choose your preferred color scheme. "Auto" follows your device's system setting.
      </p>

      <div class="space-y-3" role="radiogroup" aria-describedby="theme-help">
        <label class="radio-label">
          <input
            type="radio"
            name="theme"
            value="light"
            class="radio-input"
            {% if profile and profile.theme_preference == 'light' %}checked{% endif %}
            data-theme-toggle
            data-theme-value="light"
          />
          <span class="radio-text">
            <span class="radio-icon" aria-hidden="true">â˜€ï¸</span>
            <span>
              <strong>Light Mode</strong>
              <br>
              <span class="text-sm text-slate-500 dark:text-slate-400">Bright, clean interface</span>
            </span>
          </span>
        </label>

        <label class="radio-label">
          <input
            type="radio"
            name="theme"
            value="dark"
            class="radio-input"
            {% if profile and profile.theme_preference == 'dark' %}checked{% endif %}
            data-theme-toggle
            data-theme-value="dark"
          />
          <span class="radio-text">
            <span class="radio-icon" aria-hidden="true">ğŸŒ™</span>
            <span>
              <strong>Dark Mode</strong>
              <br>
              <span class="text-sm text-slate-500 dark:text-slate-400">Easy on the eyes at night</span>
            </span>
          </span>
        </label>

        <label class="radio-label">
          <input
            type="radio"
            name="theme"
            value="auto"
            class="radio-input"
            {% if not profile or not profile.theme_preference or profile.theme_preference == 'auto' %}checked{% endif %}
            data-theme-toggle
            data-theme-value="auto"
          />
          <span class="radio-text">
            <span class="radio-icon" aria-hidden="true">ğŸŒ“</span>
            <span>
              <strong>Auto (System)</strong>
              <br>
              <span class="text-sm text-slate-500 dark:text-slate-400">Matches your device setting</span>
            </span>
          </span>
        </label>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="mb-6">
      <button type="submit" class="btn btn-primary">
        <span aria-hidden="true">ğŸ’¾</span> Save Preferences
      </button>
    </div>
  </form>

  <!-- Privacy Info -->
  <details class="rounded-xl border border-slate-200 dark:border-slate-700">
    <summary class="px-4 py-3 cursor-pointer text-sm text-slate-600 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors rounded-xl">
      How is my location used?
    </summary>
    <div class="px-4 pb-3 pt-2 border-t border-slate-200 dark:border-slate-700">
      <p class="text-sm text-slate-500 dark:text-slate-400">
        Your location is used to provide weather-based watering adjustments for outdoor plants.
        We fetch current weather conditions from OpenWeather API to help optimize your plant care schedule.
        Your location is never shared with third parties and you can clear it at any time.
      </p>
    </div>
  </details>
</section>

<!-- Account Management -->
<section class="card mb-8 border-2 border-rose-200 dark:border-rose-800" aria-labelledby="danger-title">
  <h3 id="danger-title" class="section-title">Account Management</h3>

  <div class="space-y-4">
    <!-- Log Out -->
    <div class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl">
      <div>
        <strong class="text-slate-900 dark:text-slate-100">Log Out</strong>
        <p class="text-sm text-slate-500 dark:text-slate-400">Sign out of your account on this device.</p>
      </div>
      <a href="{{ url_for('auth.logout') }}" class="btn btn-secondary flex-shrink-0">
        Log Out
      </a>
    </div>

    <!-- Delete Account -->
    <div class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl">
      <div>
        <strong class="text-slate-900 dark:text-slate-100">Delete Account</strong>
        <p class="text-sm text-slate-500 dark:text-slate-400">Permanently delete your account and all data. This action cannot be undone.</p>
      </div>
      <button class="btn btn-secondary flex-shrink-0" disabled>
        Delete Account (Coming Soon)
      </button>
    </div>
  </div>
</section>

<!-- Back to Dashboard -->
<div class="mb-8">
  <a href="{{ url_for('dashboard.index') }}" class="text-slate-500 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors">
    <span aria-hidden="true">â†</span> Back to Dashboard
  </a>
</div>

{% endblock %}
